import { readFileSync, writeFileSync } from "fs";
import { join } from "path";

function embedAsBase64(path: string): string {
  const buffer = readFileSync(path);
  return buffer.toString("base64");
}

const SHAPER_WASM_BASE64 = embedAsBase64(join(import.meta.dirname, "..", "pkg", "shaper_bg.wasm"));

const output = `// AUTO-GENERATED FILE - DO NOT EDIT
// Generated by: bun run gen

export const SHAPER_WASM_BASE64 = "${SHAPER_WASM_BASE64}";
`;

writeFileSync(join(import.meta.dirname, "..", "ts", "gen.embedded.ts"), output);
console.log("Generated ts/gen.embedded.ts");
