# Project Description

Glade is a cross-platform JavaScript WebGPU library for building GUIs and graphics applications that run both in browsers and natively on macOS. Drawing inspiration from GPUI's patterns and concepts, it provides a unified API for creating platform-independent graphical interfaces using standard WebGPU interfaces.

## Platform Architecture

- **Browser**: Uses the native JavaScript WebGPU API with HTML Canvas elements and standard browser events
- **macOS**: Leverages GLFW for window creation and event handling, with Dawn as the WebGPU implementation
- **Core Library (`@glade/core`)**: Defines platform-agnostic types, contexts, and event interfaces that platform implementations must satisfy

## Native Dependencies

The MacOS platform uses vendored C++ dependencies included as git submodules in `./vendor`:

- **GLFW**: Window management and input handling
- **Dawn**: Google's WebGPU implementation

These are built into `.dylib` files via custom build scripts and embedded directly into the application using Bun's file-embedding capabilities. The embedded dylibs are accessed through Bun's in-memory filesystem and loaded via Bun FFI, eliminating external dependency requirements.

## WebAssembly Modules

Key functionality is provided through Rust libraries compiled to WASM:

- **Cosmic Text**: Text shaping and rendering
- **Taffy**: Flexbox and CSS Grid layout engine
- **Lyon**: SVG path parsing and tessellation

## Build System

The project relies heavily on Bun for:

- TypeScript bundling and compilation
- FFI bindings to native libraries (MacOS platform)
- Embedding binary assets directly into the application
- Building self-contained executables with all dependencies included

# Development Rules

## Package Architecture

- All packages export through `{package_name}.ts` for portability
- Use relative paths for local imports, package names for package imports
- Every package has `package.json` (regardless of language)

## Planning

- Focus only on immediate goal changes
- Ignore backward compatibility and deprecations
- Do not plan migrations unless explicitly requested

## General Code Quality

- Comments explain "why", not "what" - only for non-obvious code
- No emojis in code or comments
- Minimal, focused logging
- Follow existing project structure and patterns

## Development

- Run `bun lint && bun format && bun typecheck` to check your work.

## TypeScript/JavaScript

### Type Safety

- Never use `any`, or `as`, and avoid `as unknown`
- Use proper type guards and type assertions
- Prefer `type` over `interface`

### Imports & Dependencies

- Module-level imports only (no dynamic imports or requires)
- Static imports at the top of files

### Error Handling

- Never catch errors only to log them - handle or re-throw
- Proper error handling with meaningful feedback

### Code Style

- Double quotes for strings
- Always use braces for conditionals
- Never single-line return statements
- Use `??` for null/undefined checks, `||` for falsy checks
- No shebangs in TypeScript files

### Examples

- Concise with minimal verbose output
- No `satisfies` operators in examples
